{{- if .Values.secretProviderClass.enabled }}
apiVersion: secrets-store.csi.x-k8s.io/v1
kind: SecretProviderClass
metadata:
  name: {{ include "document-download.fullname" . }}
  labels:
    {{- include "document-download.labels" . | nindent 4 }}
spec:
  provider: {{ .Values.secretProviderClass.provider }}
  #This is the source names from AWS Secrets Manager
  parameters:
    objects: |
      - objectName: MANIFEST_SECRET_KEY
        objectType: "secretsmanager"
      - objectName: MANIFEST_NEW_RELIC_LICENSE_KEY
        objectType: "secretsmanager"
      - objectName: MANIFEST_DEBUG_KEY
        objectType: "secretsmanager"

  #This is the target name in the kubernetes secret      
  secretObjects:
    - data:
      - key: SECRET_KEY 
        objectName: MANIFEST_SECRET_KEY   
      - key: NEW_RELIC_LICENSE_KEY
        objectName: MANIFEST_NEW_RELIC_LICENSE_KEY
      - key: DEBUG_KEY  
        objectName: MANIFEST_DEBUG_KEY
      secretName: document-download
      type: generic

{{ end }}
